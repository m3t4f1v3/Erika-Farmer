import { verify } from "https://unpkg.com/@evan/wasm@0.0.93/target/ed25519/deno.js";
export function verifySignature({ publicKey, signature, timestamp, body }) {
    const isValid = verify(hexToUint8Array(publicKey), hexToUint8Array(signature), new TextEncoder().encode(timestamp + body));
    return { isValid, body };
}
function hexToUint8Array(hex) {
    return new Uint8Array(hex.match(/.{1,2}/g).map((val) => parseInt(val, 16)));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVyaWZ5U2lnbmF0dXJlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsidmVyaWZ5U2lnbmF0dXJlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSw0REFBNEQsQ0FBQztBQUVwRixNQUFNLFVBQVUsZUFBZSxDQUFDLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUEwQjtJQUkvRixNQUFNLE9BQU8sR0FBRyxNQUFNLENBQ3BCLGVBQWUsQ0FBQyxTQUFTLENBQUMsRUFDMUIsZUFBZSxDQUFDLFNBQVMsQ0FBQyxFQUMxQixJQUFJLFdBQVcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLENBQzNDLENBQUM7SUFFRixPQUFPLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxDQUFDO0FBQzNCLENBQUM7QUFHRCxTQUFTLGVBQWUsQ0FBQyxHQUFXO0lBQ2xDLE9BQU8sSUFBSSxVQUFVLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLFFBQVEsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQy9FLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB2ZXJpZnkgfSBmcm9tIFwiaHR0cHM6Ly91bnBrZy5jb20vQGV2YW4vd2FzbUAwLjAuOTMvdGFyZ2V0L2VkMjU1MTkvZGVuby5qc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5U2lnbmF0dXJlKHsgcHVibGljS2V5LCBzaWduYXR1cmUsIHRpbWVzdGFtcCwgYm9keSB9OiBWZXJpZnlTaWduYXR1cmVPcHRpb25zKToge1xuICBpc1ZhbGlkOiBib29sZWFuO1xuICBib2R5OiBzdHJpbmc7XG59IHtcbiAgY29uc3QgaXNWYWxpZCA9IHZlcmlmeShcbiAgICBoZXhUb1VpbnQ4QXJyYXkocHVibGljS2V5KSxcbiAgICBoZXhUb1VpbnQ4QXJyYXkoc2lnbmF0dXJlKSxcbiAgICBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUodGltZXN0YW1wICsgYm9keSksXG4gICk7XG5cbiAgcmV0dXJuIHsgaXNWYWxpZCwgYm9keSB9O1xufVxuXG4vKiogQ29udmVydHMgYSBoZXhhZGVjaW1hbCBzdHJpbmcgdG8gVWludDhBcnJheS4gKi9cbmZ1bmN0aW9uIGhleFRvVWludDhBcnJheShoZXg6IHN0cmluZykge1xuICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoaGV4Lm1hdGNoKC8uezEsMn0vZykhLm1hcCgodmFsKSA9PiBwYXJzZUludCh2YWwsIDE2KSkpO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZlcmlmeVNpZ25hdHVyZU9wdGlvbnMge1xuICBwdWJsaWNLZXk6IHN0cmluZztcbiAgc2lnbmF0dXJlOiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogc3RyaW5nO1xuICBib2R5OiBzdHJpbmc7XG59XG4iXX0=