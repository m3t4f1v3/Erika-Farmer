import { ApplicationCommandTypes } from "../../../mod.ts";
export async function createApplicationCommand(bot, options, guildId) {
    const result = await bot.rest.runMethod(bot.rest, "POST", guildId
        ? bot.constants.routes.COMMANDS_GUILD(bot.applicationId, guildId)
        : bot.constants.routes.COMMANDS(bot.applicationId), isContextApplicationCommand(options)
        ? { name: options.name, name_localizations: options.nameLocalizations, type: options.type }
        : {
            name: options.name,
            name_localizations: options.nameLocalizations,
            description: options.description,
            description_localizations: options.descriptionLocalizations,
            type: options.type,
            options: options.options ? makeOptionsForCommand(options.options) : undefined,
            default_member_permissions: options.defaultMemberPermissions
                ? bot.utils.calculateBits(options.defaultMemberPermissions)
                : undefined,
            dm_permission: options.dmPermission,
        });
    return bot.transformers.applicationCommand(bot, result);
}
export function makeOptionsForCommand(options) {
    return options.map((option) => ({
        type: option.type,
        name: option.name,
        name_localizations: option.nameLocalizations,
        description: option.description,
        description_localizations: option.descriptionLocalizations,
        required: option.required,
        choices: option.choices?.map((choice) => ({
            name: choice.name,
            name_localizations: choice.nameLocalizations,
            value: choice.value,
        })),
        options: option.options ? makeOptionsForCommand(option.options) : undefined,
        channel_types: option.channelTypes,
        autocomplete: option.autocomplete,
        min_value: option.minValue,
        max_value: option.maxValue,
    }));
}
export function isContextApplicationCommand(cmd) {
    return cmd.type === ApplicationCommandTypes.Message || cmd.type === ApplicationCommandTypes.User;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlQXBwbGljYXRpb25Db21tYW5kLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY3JlYXRlQXBwbGljYXRpb25Db21tYW5kLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBNEIsdUJBQXVCLEVBQWdCLE1BQU0saUJBQWlCLENBQUM7QUFlbEcsTUFBTSxDQUFDLEtBQUssVUFBVSx3QkFBd0IsQ0FDNUMsR0FBUSxFQUNSLE9BQW1FLEVBQ25FLE9BQWdCO0lBRWhCLE1BQU0sTUFBTSxHQUFHLE1BQU0sR0FBRyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQ3JDLEdBQUcsQ0FBQyxJQUFJLEVBQ1IsTUFBTSxFQUNOLE9BQU87UUFDTCxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsT0FBTyxDQUFDO1FBQ2pFLENBQUMsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxFQUNwRCwyQkFBMkIsQ0FBQyxPQUFPLENBQUM7UUFDbEMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLE9BQU8sQ0FBQyxJQUFJLEVBQUUsa0JBQWtCLEVBQUUsT0FBTyxDQUFDLGlCQUFpQixFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsSUFBSSxFQUFFO1FBQzNGLENBQUMsQ0FBQztZQUNBLElBQUksRUFBRSxPQUFPLENBQUMsSUFBSTtZQUNsQixrQkFBa0IsRUFBRSxPQUFPLENBQUMsaUJBQWlCO1lBQzdDLFdBQVcsRUFBRSxPQUFPLENBQUMsV0FBVztZQUNoQyx5QkFBeUIsRUFBRSxPQUFPLENBQUMsd0JBQXdCO1lBQzNELElBQUksRUFBRSxPQUFPLENBQUMsSUFBSTtZQUNsQixPQUFPLEVBQUUsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMscUJBQXFCLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTO1lBQzdFLDBCQUEwQixFQUFFLE9BQU8sQ0FBQyx3QkFBd0I7Z0JBQzFELENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsd0JBQXdCLENBQUM7Z0JBQzNELENBQUMsQ0FBQyxTQUFTO1lBQ2IsYUFBYSxFQUFFLE9BQU8sQ0FBQyxZQUFZO1NBQ3BDLENBQ0osQ0FBQztJQUVGLE9BQU8sR0FBRyxDQUFDLFlBQVksQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDMUQsQ0FBQztBQUVELE1BQU0sVUFBVSxxQkFBcUIsQ0FBQyxPQUFtQztJQUN2RSxPQUFPLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDOUIsSUFBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJO1FBQ2pCLElBQUksRUFBRSxNQUFNLENBQUMsSUFBSTtRQUNqQixrQkFBa0IsRUFBRSxNQUFNLENBQUMsaUJBQWlCO1FBQzVDLFdBQVcsRUFBRSxNQUFNLENBQUMsV0FBVztRQUMvQix5QkFBeUIsRUFBRSxNQUFNLENBQUMsd0JBQXdCO1FBQzFELFFBQVEsRUFBRSxNQUFNLENBQUMsUUFBUTtRQUN6QixPQUFPLEVBQUUsTUFBTSxDQUFDLE9BQU8sRUFBRSxHQUFHLENBQUMsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDeEMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJO1lBQ2pCLGtCQUFrQixFQUFFLE1BQU0sQ0FBQyxpQkFBaUI7WUFDNUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxLQUFLO1NBQ3BCLENBQUMsQ0FBQztRQUNILE9BQU8sRUFBRSxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVM7UUFDM0UsYUFBYSxFQUFFLE1BQU0sQ0FBQyxZQUFZO1FBQ2xDLFlBQVksRUFBRSxNQUFNLENBQUMsWUFBWTtRQUNqQyxTQUFTLEVBQUUsTUFBTSxDQUFDLFFBQVE7UUFDMUIsU0FBUyxFQUFFLE1BQU0sQ0FBQyxRQUFRO0tBQzNCLENBQUMsQ0FBQyxDQUFDO0FBQ04sQ0FBQztBQWtDRCxNQUFNLFVBQVUsMkJBQTJCLENBQ3pDLEdBQXVGO0lBRXZGLE9BQU8sR0FBRyxDQUFDLElBQUksS0FBSyx1QkFBdUIsQ0FBQyxPQUFPLElBQUksR0FBRyxDQUFDLElBQUksS0FBSyx1QkFBdUIsQ0FBQyxJQUFJLENBQUM7QUFDbkcsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgQm90IH0gZnJvbSBcIi4uLy4uLy4uL2JvdC50c1wiO1xuaW1wb3J0IHsgQXBwbGljYXRpb25Db21tYW5kT3B0aW9uLCBBcHBsaWNhdGlvbkNvbW1hbmRUeXBlcywgTG9jYWxpemF0aW9uIH0gZnJvbSBcIi4uLy4uLy4uL21vZC50c1wiO1xuaW1wb3J0IHsgRGlzY29yZEFwcGxpY2F0aW9uQ29tbWFuZCwgRGlzY29yZEFwcGxpY2F0aW9uQ29tbWFuZE9wdGlvbiB9IGZyb20gXCIuLi8uLi8uLi90eXBlcy9kaXNjb3JkLnRzXCI7XG5pbXBvcnQgeyBBdExlYXN0T25lLCBQZXJtaXNzaW9uU3RyaW5ncyB9IGZyb20gXCIuLi8uLi8uLi90eXBlcy9zaGFyZWQudHNcIjtcblxuLyoqXG4gKiBUaGVyZSBhcmUgdHdvIGtpbmRzIG9mIEFwcGxpY2F0aW9uIENvbW1hbmRzOiBnbG9iYWwgY29tbWFuZHMgYW5kIGd1aWxkIGNvbW1hbmRzLiBHbG9iYWwgY29tbWFuZHMgYXJlIGF2YWlsYWJsZSBmb3IgZXZlcnkgZ3VpbGQgdGhhdCBhZGRzIHlvdXIgYXBwOyBndWlsZCBjb21tYW5kcyBhcmUgc3BlY2lmaWMgdG8gdGhlIGd1aWxkIHlvdSBzcGVjaWZ5IHdoZW4gbWFraW5nIHRoZW0uIENvbW1hbmQgbmFtZXMgYXJlIHVuaXF1ZSBwZXIgYXBwbGljYXRpb24gd2l0aGluIGVhY2ggc2NvcGUgKGdsb2JhbCBhbmQgZ3VpbGQpLiBUaGF0IG1lYW5zOlxuICpcbiAqIC0gWW91ciBhcHAgKipjYW5ub3QqKiBoYXZlIHR3byBnbG9iYWwgY29tbWFuZHMgd2l0aCB0aGUgc2FtZSBuYW1lXG4gKiAtIFlvdXIgYXBwICoqY2Fubm90KiogaGF2ZSB0d28gZ3VpbGQgY29tbWFuZHMgd2l0aGluIHRoZSBzYW1lIG5hbWUgKipvbiB0aGUgc2FtZSBndWlsZCoqXG4gKiAtIFlvdXIgYXBwICoqY2FuKiogaGF2ZSBhIGdsb2JhbCBhbmQgZ3VpbGQgY29tbWFuZCB3aXRoIHRoZSBzYW1lIG5hbWVcbiAqIC0gTXVsdGlwbGUgYXBwcyAqKmNhbioqIGhhdmUgY29tbWFuZHMgd2l0aCB0aGUgc2FtZSBuYW1lc1xuICpcbiAqIEdsb2JhbCBjb21tYW5kcyBhcmUgY2FjaGVkIGZvciAqKjEgaG91cioqLiBUaGF0IG1lYW5zIHRoYXQgbmV3IGdsb2JhbCBjb21tYW5kcyB3aWxsIGZhbiBvdXQgc2xvd2x5IGFjcm9zcyBhbGwgZ3VpbGRzLCBhbmQgd2lsbCBiZSBndWFyYW50ZWVkIHRvIGJlIHVwZGF0ZWQgaW4gYW4gaG91ci5cbiAqIEd1aWxkIGNvbW1hbmRzIHVwZGF0ZSAqKmluc3RhbnRseSoqLiBXZSByZWNvbW1lbmQgeW91IHVzZSBndWlsZCBjb21tYW5kcyBmb3IgcXVpY2sgdGVzdGluZywgYW5kIGdsb2JhbCBjb21tYW5kcyB3aGVuIHRoZXkncmUgcmVhZHkgZm9yIHB1YmxpYyB1c2UuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVBcHBsaWNhdGlvbkNvbW1hbmQoXG4gIGJvdDogQm90LFxuICBvcHRpb25zOiBDcmVhdGVBcHBsaWNhdGlvbkNvbW1hbmQgfCBDcmVhdGVDb250ZXh0QXBwbGljYXRpb25Db21tYW5kLFxuICBndWlsZElkPzogYmlnaW50LFxuKSB7XG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGJvdC5yZXN0LnJ1bk1ldGhvZDxEaXNjb3JkQXBwbGljYXRpb25Db21tYW5kPihcbiAgICBib3QucmVzdCxcbiAgICBcIlBPU1RcIixcbiAgICBndWlsZElkXG4gICAgICA/IGJvdC5jb25zdGFudHMucm91dGVzLkNPTU1BTkRTX0dVSUxEKGJvdC5hcHBsaWNhdGlvbklkLCBndWlsZElkKVxuICAgICAgOiBib3QuY29uc3RhbnRzLnJvdXRlcy5DT01NQU5EUyhib3QuYXBwbGljYXRpb25JZCksXG4gICAgaXNDb250ZXh0QXBwbGljYXRpb25Db21tYW5kKG9wdGlvbnMpXG4gICAgICA/IHsgbmFtZTogb3B0aW9ucy5uYW1lLCBuYW1lX2xvY2FsaXphdGlvbnM6IG9wdGlvbnMubmFtZUxvY2FsaXphdGlvbnMsIHR5cGU6IG9wdGlvbnMudHlwZSB9XG4gICAgICA6IHtcbiAgICAgICAgbmFtZTogb3B0aW9ucy5uYW1lLFxuICAgICAgICBuYW1lX2xvY2FsaXphdGlvbnM6IG9wdGlvbnMubmFtZUxvY2FsaXphdGlvbnMsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBvcHRpb25zLmRlc2NyaXB0aW9uLFxuICAgICAgICBkZXNjcmlwdGlvbl9sb2NhbGl6YXRpb25zOiBvcHRpb25zLmRlc2NyaXB0aW9uTG9jYWxpemF0aW9ucyxcbiAgICAgICAgdHlwZTogb3B0aW9ucy50eXBlLFxuICAgICAgICBvcHRpb25zOiBvcHRpb25zLm9wdGlvbnMgPyBtYWtlT3B0aW9uc0ZvckNvbW1hbmQob3B0aW9ucy5vcHRpb25zKSA6IHVuZGVmaW5lZCxcbiAgICAgICAgZGVmYXVsdF9tZW1iZXJfcGVybWlzc2lvbnM6IG9wdGlvbnMuZGVmYXVsdE1lbWJlclBlcm1pc3Npb25zXG4gICAgICAgICAgPyBib3QudXRpbHMuY2FsY3VsYXRlQml0cyhvcHRpb25zLmRlZmF1bHRNZW1iZXJQZXJtaXNzaW9ucylcbiAgICAgICAgICA6IHVuZGVmaW5lZCxcbiAgICAgICAgZG1fcGVybWlzc2lvbjogb3B0aW9ucy5kbVBlcm1pc3Npb24sXG4gICAgICB9LFxuICApO1xuXG4gIHJldHVybiBib3QudHJhbnNmb3JtZXJzLmFwcGxpY2F0aW9uQ29tbWFuZChib3QsIHJlc3VsdCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYWtlT3B0aW9uc0ZvckNvbW1hbmQob3B0aW9uczogQXBwbGljYXRpb25Db21tYW5kT3B0aW9uW10pOiBEaXNjb3JkQXBwbGljYXRpb25Db21tYW5kT3B0aW9uW10ge1xuICByZXR1cm4gb3B0aW9ucy5tYXAoKG9wdGlvbikgPT4gKHtcbiAgICB0eXBlOiBvcHRpb24udHlwZSxcbiAgICBuYW1lOiBvcHRpb24ubmFtZSxcbiAgICBuYW1lX2xvY2FsaXphdGlvbnM6IG9wdGlvbi5uYW1lTG9jYWxpemF0aW9ucyxcbiAgICBkZXNjcmlwdGlvbjogb3B0aW9uLmRlc2NyaXB0aW9uLFxuICAgIGRlc2NyaXB0aW9uX2xvY2FsaXphdGlvbnM6IG9wdGlvbi5kZXNjcmlwdGlvbkxvY2FsaXphdGlvbnMsXG4gICAgcmVxdWlyZWQ6IG9wdGlvbi5yZXF1aXJlZCxcbiAgICBjaG9pY2VzOiBvcHRpb24uY2hvaWNlcz8ubWFwKChjaG9pY2UpID0+ICh7XG4gICAgICBuYW1lOiBjaG9pY2UubmFtZSxcbiAgICAgIG5hbWVfbG9jYWxpemF0aW9uczogY2hvaWNlLm5hbWVMb2NhbGl6YXRpb25zLFxuICAgICAgdmFsdWU6IGNob2ljZS52YWx1ZSxcbiAgICB9KSksXG4gICAgb3B0aW9uczogb3B0aW9uLm9wdGlvbnMgPyBtYWtlT3B0aW9uc0ZvckNvbW1hbmQob3B0aW9uLm9wdGlvbnMpIDogdW5kZWZpbmVkLFxuICAgIGNoYW5uZWxfdHlwZXM6IG9wdGlvbi5jaGFubmVsVHlwZXMsXG4gICAgYXV0b2NvbXBsZXRlOiBvcHRpb24uYXV0b2NvbXBsZXRlLFxuICAgIG1pbl92YWx1ZTogb3B0aW9uLm1pblZhbHVlLFxuICAgIG1heF92YWx1ZTogb3B0aW9uLm1heFZhbHVlLFxuICB9KSk7XG59XG5cbi8qKiBodHRwczovL2Rpc2NvcmQuY29tL2RldmVsb3BlcnMvZG9jcy9pbnRlcmFjdGlvbnMvYXBwbGljYXRpb24tY29tbWFuZHMjZW5kcG9pbnRzLWpzb24tcGFyYW1zICovXG5leHBvcnQgaW50ZXJmYWNlIENyZWF0ZUFwcGxpY2F0aW9uQ29tbWFuZCB7XG4gIC8qKlxuICAgKiBOYW1lIG9mIGNvbW1hbmQsIDEtMzIgY2hhcmFjdGVycy5cbiAgICogYEFwcGxpY2F0aW9uQ29tbWFuZFR5cGVzLkNoYXRJbnB1dGAgY29tbWFuZCBuYW1lcyBtdXN0IG1hdGNoIHRoZSBmb2xsb3dpbmcgcmVnZXggYF5bLV9cXHB7TH1cXHB7Tn1cXHB7c2M9RGV2YX1cXHB7c2M9VGhhaX1dezEsMzJ9JGAgd2l0aCB0aGUgdW5pY29kZSBmbGFnIHNldC5cbiAgICogSWYgdGhlcmUgaXMgYSBsb3dlcmNhc2UgdmFyaWFudCBvZiBhbnkgbGV0dGVycyB1c2VkLCB5b3UgbXVzdCB1c2UgdGhvc2UuXG4gICAqIENoYXJhY3RlcnMgd2l0aCBubyBsb3dlcmNhc2UgdmFyaWFudHMgYW5kL29yIHVuY2FzZWQgbGV0dGVycyBhcmUgc3RpbGwgYWxsb3dlZC5cbiAgICogQXBwbGljYXRpb25Db21tYW5kVHlwZXMuVXNlcmAgYW5kIGBBcHBsaWNhdGlvbkNvbW1hbmRUeXBlcy5NZXNzYWdlYCBjb21tYW5kcyBtYXkgYmUgbWl4ZWQgY2FzZSBhbmQgY2FuIGluY2x1ZGUgc3BhY2VzLlxuICAgKi9cbiAgbmFtZTogc3RyaW5nO1xuICAvKiogTG9jYWxpemF0aW9uIG9iamVjdCBmb3IgdGhlIGBuYW1lYCBmaWVsZC4gVmFsdWVzIGZvbGxvdyB0aGUgc2FtZSByZXN0cmljdGlvbnMgYXMgYG5hbWVgICovXG4gIG5hbWVMb2NhbGl6YXRpb25zPzogTG9jYWxpemF0aW9uO1xuICAvKiogMS0xMDAgY2hhcmFjdGVyIGRlc2NyaXB0aW9uICovXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIC8qKiBMb2NhbGl6YXRpb24gb2JqZWN0IGZvciB0aGUgYGRlc2NyaXB0aW9uYCBmaWVsZC4gVmFsdWVzIGZvbGxvdyB0aGUgc2FtZSByZXN0cmljdGlvbnMgYXMgYGRlc2NyaXB0aW9uYCAqL1xuICBkZXNjcmlwdGlvbkxvY2FsaXphdGlvbnM/OiBMb2NhbGl6YXRpb247XG4gIC8qKiBUeXBlIG9mIGNvbW1hbmQsIGRlZmF1bHRzIGBBcHBsaWNhdGlvbkNvbW1hbmRUeXBlcy5DaGF0SW5wdXRgIGlmIG5vdCBzZXQgICovXG4gIHR5cGU/OiBBcHBsaWNhdGlvbkNvbW1hbmRUeXBlcztcbiAgLyoqIFBhcmFtZXRlcnMgZm9yIHRoZSBjb21tYW5kICovXG4gIG9wdGlvbnM/OiBBcHBsaWNhdGlvbkNvbW1hbmRPcHRpb25bXTtcbiAgLyoqIFNldCBvZiBwZXJtaXNzaW9ucyByZXByZXNlbnRlZCBhcyBhIGJpdCBzZXQgKi9cbiAgZGVmYXVsdE1lbWJlclBlcm1pc3Npb25zPzogUGVybWlzc2lvblN0cmluZ3NbXTtcbiAgLyoqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBjb21tYW5kIGlzIGF2YWlsYWJsZSBpbiBETXMgd2l0aCB0aGUgYXBwLCBvbmx5IGZvciBnbG9iYWxseS1zY29wZWQgY29tbWFuZHMuIEJ5IGRlZmF1bHQsIGNvbW1hbmRzIGFyZSB2aXNpYmxlLiAqL1xuICBkbVBlcm1pc3Npb24/OiBib29sZWFuO1xufVxuXG4vKiogaHR0cHM6Ly9kaXNjb3JkLmNvbS9kZXZlbG9wZXJzL2RvY3MvaW50ZXJhY3Rpb25zL2FwcGxpY2F0aW9uLWNvbW1hbmRzI2VuZHBvaW50cy1qc29uLXBhcmFtcyAqL1xuZXhwb3J0IGludGVyZmFjZSBDcmVhdGVDb250ZXh0QXBwbGljYXRpb25Db21tYW5kIGV4dGVuZHMgT21pdDxDcmVhdGVBcHBsaWNhdGlvbkNvbW1hbmQsIFwib3B0aW9uc1wiPiB7XG4gIC8qKiBUaGUgdHlwZSBvZiB0aGUgY29tbWFuZCAqL1xuICB0eXBlOiBBcHBsaWNhdGlvbkNvbW1hbmRUeXBlcy5NZXNzYWdlIHwgQXBwbGljYXRpb25Db21tYW5kVHlwZXMuVXNlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQ29udGV4dEFwcGxpY2F0aW9uQ29tbWFuZChcbiAgY21kOiBBdExlYXN0T25lPENyZWF0ZUNvbnRleHRBcHBsaWNhdGlvbkNvbW1hbmQ+IHwgQXRMZWFzdE9uZTxDcmVhdGVBcHBsaWNhdGlvbkNvbW1hbmQ+LFxuKTogY21kIGlzIEF0TGVhc3RPbmU8Q3JlYXRlQ29udGV4dEFwcGxpY2F0aW9uQ29tbWFuZD4ge1xuICByZXR1cm4gY21kLnR5cGUgPT09IEFwcGxpY2F0aW9uQ29tbWFuZFR5cGVzLk1lc3NhZ2UgfHwgY21kLnR5cGUgPT09IEFwcGxpY2F0aW9uQ29tbWFuZFR5cGVzLlVzZXI7XG59XG4iXX0=