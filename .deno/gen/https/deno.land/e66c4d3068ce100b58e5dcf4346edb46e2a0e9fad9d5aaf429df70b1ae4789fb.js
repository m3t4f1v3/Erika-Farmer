import { requireBotChannelPermissions } from "../permissions.ts";
export function getMessage(bot) {
    const getMessageOld = bot.helpers.getMessage;
    bot.helpers.getMessage = async function (channelId, messageId) {
        const channel = bot.channels.get(channelId);
        if (channel?.guildId) {
            requireBotChannelPermissions(bot, channel, [
                "READ_MESSAGE_HISTORY",
            ]);
        }
        return await getMessageOld(channelId, messageId);
    };
}
export function getMessages(bot) {
    const getMessagesOld = bot.helpers.getMessages;
    bot.helpers.getMessages = async function (channelId, options) {
        const channel = bot.channels.get(channelId);
        if (channel?.guildId) {
            requireBotChannelPermissions(bot, channel, [
                "READ_MESSAGE_HISTORY",
                "VIEW_CHANNEL",
            ]);
        }
        return await getMessagesOld(channelId, options);
    };
}
export default function setupGetMessagePermChecks(bot) {
    getMessage(bot);
    getMessages(bot);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZ2V0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSw0QkFBNEIsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBRWpFLE1BQU0sVUFBVSxVQUFVLENBQUMsR0FBaUI7SUFDMUMsTUFBTSxhQUFhLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUM7SUFFN0MsR0FBRyxDQUFDLE9BQU8sQ0FBQyxVQUFVLEdBQUcsS0FBSyxXQUM1QixTQUFTLEVBQ1QsU0FBUztRQUVULE1BQU0sT0FBTyxHQUFHLEdBQUcsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzVDLElBQUksT0FBTyxFQUFFLE9BQU8sRUFBRTtZQUNwQiw0QkFBNEIsQ0FBQyxHQUFHLEVBQUUsT0FBTyxFQUFFO2dCQUN6QyxzQkFBc0I7YUFDdkIsQ0FBQyxDQUFDO1NBQ0o7UUFFRCxPQUFPLE1BQU0sYUFBYSxDQUFDLFNBQVMsRUFBRSxTQUFTLENBQUMsQ0FBQztJQUNuRCxDQUFDLENBQUM7QUFDSixDQUFDO0FBRUQsTUFBTSxVQUFVLFdBQVcsQ0FBQyxHQUFpQjtJQUMzQyxNQUFNLGNBQWMsR0FBRyxHQUFHLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQztJQUUvQyxHQUFHLENBQUMsT0FBTyxDQUFDLFdBQVcsR0FBRyxLQUFLLFdBQzdCLFNBQVMsRUFDVCxPQUFPO1FBRVAsTUFBTSxPQUFPLEdBQUcsR0FBRyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDNUMsSUFBSSxPQUFPLEVBQUUsT0FBTyxFQUFFO1lBQ3BCLDRCQUE0QixDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUU7Z0JBQ3pDLHNCQUFzQjtnQkFDdEIsY0FBYzthQUNmLENBQUMsQ0FBQztTQUNKO1FBRUQsT0FBTyxNQUFNLGNBQWMsQ0FBQyxTQUFTLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDbEQsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUVELE1BQU0sQ0FBQyxPQUFPLFVBQVUseUJBQXlCLENBQUMsR0FBaUI7SUFDakUsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2hCLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNuQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQm90V2l0aENhY2hlIH0gZnJvbSBcIi4uLy4uL2RlcHMudHNcIjtcbmltcG9ydCB7IHJlcXVpcmVCb3RDaGFubmVsUGVybWlzc2lvbnMgfSBmcm9tIFwiLi4vcGVybWlzc2lvbnMudHNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1lc3NhZ2UoYm90OiBCb3RXaXRoQ2FjaGUpIHtcbiAgY29uc3QgZ2V0TWVzc2FnZU9sZCA9IGJvdC5oZWxwZXJzLmdldE1lc3NhZ2U7XG5cbiAgYm90LmhlbHBlcnMuZ2V0TWVzc2FnZSA9IGFzeW5jIGZ1bmN0aW9uIChcbiAgICBjaGFubmVsSWQsXG4gICAgbWVzc2FnZUlkLFxuICApIHtcbiAgICBjb25zdCBjaGFubmVsID0gYm90LmNoYW5uZWxzLmdldChjaGFubmVsSWQpO1xuICAgIGlmIChjaGFubmVsPy5ndWlsZElkKSB7XG4gICAgICByZXF1aXJlQm90Q2hhbm5lbFBlcm1pc3Npb25zKGJvdCwgY2hhbm5lbCwgW1xuICAgICAgICBcIlJFQURfTUVTU0FHRV9ISVNUT1JZXCIsXG4gICAgICBdKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYXdhaXQgZ2V0TWVzc2FnZU9sZChjaGFubmVsSWQsIG1lc3NhZ2VJZCk7XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRNZXNzYWdlcyhib3Q6IEJvdFdpdGhDYWNoZSkge1xuICBjb25zdCBnZXRNZXNzYWdlc09sZCA9IGJvdC5oZWxwZXJzLmdldE1lc3NhZ2VzO1xuXG4gIGJvdC5oZWxwZXJzLmdldE1lc3NhZ2VzID0gYXN5bmMgZnVuY3Rpb24gKFxuICAgIGNoYW5uZWxJZCxcbiAgICBvcHRpb25zLFxuICApIHtcbiAgICBjb25zdCBjaGFubmVsID0gYm90LmNoYW5uZWxzLmdldChjaGFubmVsSWQpO1xuICAgIGlmIChjaGFubmVsPy5ndWlsZElkKSB7XG4gICAgICByZXF1aXJlQm90Q2hhbm5lbFBlcm1pc3Npb25zKGJvdCwgY2hhbm5lbCwgW1xuICAgICAgICBcIlJFQURfTUVTU0FHRV9ISVNUT1JZXCIsXG4gICAgICAgIFwiVklFV19DSEFOTkVMXCIsXG4gICAgICBdKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYXdhaXQgZ2V0TWVzc2FnZXNPbGQoY2hhbm5lbElkLCBvcHRpb25zKTtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gc2V0dXBHZXRNZXNzYWdlUGVybUNoZWNrcyhib3Q6IEJvdFdpdGhDYWNoZSkge1xuICBnZXRNZXNzYWdlKGJvdCk7XG4gIGdldE1lc3NhZ2VzKGJvdCk7XG59XG4iXX0=