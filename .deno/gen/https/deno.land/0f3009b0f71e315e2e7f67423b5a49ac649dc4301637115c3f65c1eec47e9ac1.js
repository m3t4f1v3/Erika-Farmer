import { ScheduledEventEntityType } from "../../deps.ts";
import { requireBotChannelPermissions, requireBotGuildPermissions } from "../permissions.ts";
export function createScheduledEvent(bot) {
    const createScheduledEventOld = bot.helpers.createScheduledEvent;
    bot.helpers.createScheduledEvent = async function (guildId, options) {
        if (options.entityType === ScheduledEventEntityType.StageInstance) {
            if (!options.channelId) {
                throw new Error("A channel id is required for creating a stage scheduled event.");
            }
            requireBotChannelPermissions(bot, options.channelId, [
                "MANAGE_CHANNELS",
                "MUTE_MEMBERS",
                "MOVE_MEMBERS",
            ]);
            try {
                requireBotGuildPermissions(bot, guildId, [
                    "MANAGE_EVENTS",
                ]);
            }
            catch {
                requireBotChannelPermissions(bot, options.channelId, [
                    "MANAGE_EVENTS",
                ]);
            }
            return createScheduledEventOld(guildId, options);
        }
        if (options.entityType === ScheduledEventEntityType.Voice) {
            if (!options.channelId) {
                throw new Error("A channel id is required for creating a voice scheduled event.");
            }
            requireBotChannelPermissions(bot, options.channelId, [
                "VIEW_CHANNEL",
                "CONNECT",
            ]);
            try {
                requireBotGuildPermissions(bot, guildId, [
                    "MANAGE_EVENTS",
                ]);
            }
            catch {
                requireBotChannelPermissions(bot, options.channelId, [
                    "MANAGE_EVENTS",
                ]);
            }
            return createScheduledEventOld(guildId, options);
        }
        requireBotGuildPermissions(bot, guildId, [
            "MANAGE_EVENTS",
        ]);
        return await createScheduledEventOld(guildId, options);
    };
}
export function editScheduledEvent(bot) {
    const editScheduledEventOld = bot.helpers.editScheduledEvent;
    bot.helpers.editScheduledEvent = async function (guildId, eventId, options) {
        if (options.entityType === ScheduledEventEntityType.StageInstance) {
            if (!options.channelId) {
                throw new Error("A channel id is required for creating a stage scheduled event.");
            }
            requireBotChannelPermissions(bot, options.channelId, [
                "MANAGE_CHANNELS",
                "MUTE_MEMBERS",
                "MOVE_MEMBERS",
            ]);
            try {
                requireBotGuildPermissions(bot, guildId, [
                    "MANAGE_EVENTS",
                ]);
            }
            catch {
                requireBotChannelPermissions(bot, options.channelId, [
                    "MANAGE_EVENTS",
                ]);
            }
            return editScheduledEventOld(guildId, eventId, options);
        }
        if (options.entityType === ScheduledEventEntityType.Voice) {
            if (!options.channelId) {
                throw new Error("A channel id is required for creating a voice scheduled event.");
            }
            requireBotChannelPermissions(bot, options.channelId, [
                "VIEW_CHANNEL",
                "CONNECT",
            ]);
            try {
                requireBotGuildPermissions(bot, guildId, [
                    "MANAGE_EVENTS",
                ]);
            }
            catch {
                requireBotChannelPermissions(bot, options.channelId, [
                    "MANAGE_EVENTS",
                ]);
            }
            return editScheduledEventOld(guildId, eventId, options);
        }
        requireBotGuildPermissions(bot, guildId, [
            "MANAGE_EVENTS",
        ]);
        return await editScheduledEventOld(guildId, eventId, options);
    };
}
export default function setupEventsPermChecks(bot) {
    createScheduledEvent(bot);
    editScheduledEvent(bot);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXZlbnRzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZXZlbnRzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBZ0Isd0JBQXdCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDdkUsT0FBTyxFQUFFLDRCQUE0QixFQUFFLDBCQUEwQixFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFN0YsTUFBTSxVQUFVLG9CQUFvQixDQUFDLEdBQWlCO0lBQ3BELE1BQU0sdUJBQXVCLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQztJQUVqRSxHQUFHLENBQUMsT0FBTyxDQUFDLG9CQUFvQixHQUFHLEtBQUssV0FBVyxPQUFPLEVBQUUsT0FBTztRQUNqRSxJQUFJLE9BQU8sQ0FBQyxVQUFVLEtBQUssd0JBQXdCLENBQUMsYUFBYSxFQUFFO1lBQ2pFLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFO2dCQUN0QixNQUFNLElBQUksS0FBSyxDQUNiLGdFQUFnRSxDQUNqRSxDQUFDO2FBQ0g7WUFFRCw0QkFBNEIsQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLFNBQVMsRUFBRTtnQkFDbkQsaUJBQWlCO2dCQUNqQixjQUFjO2dCQUNkLGNBQWM7YUFDZixDQUFDLENBQUM7WUFHSCxJQUFJO2dCQUNGLDBCQUEwQixDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUU7b0JBQ3ZDLGVBQWU7aUJBQ2hCLENBQUMsQ0FBQzthQUNKO1lBQUMsTUFBTTtnQkFDTiw0QkFBNEIsQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLFNBQVMsRUFBRTtvQkFDbkQsZUFBZTtpQkFDaEIsQ0FBQyxDQUFDO2FBQ0o7WUFFRCxPQUFPLHVCQUF1QixDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztTQUNsRDtRQUVELElBQUksT0FBTyxDQUFDLFVBQVUsS0FBSyx3QkFBd0IsQ0FBQyxLQUFLLEVBQUU7WUFDekQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUU7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LG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzFCLGtCQUFrQixDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQzFCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCb3RXaXRoQ2FjaGUsIFNjaGVkdWxlZEV2ZW50RW50aXR5VHlwZSB9IGZyb20gXCIuLi8uLi9kZXBzLnRzXCI7XG5pbXBvcnQgeyByZXF1aXJlQm90Q2hhbm5lbFBlcm1pc3Npb25zLCByZXF1aXJlQm90R3VpbGRQZXJtaXNzaW9ucyB9IGZyb20gXCIuLi9wZXJtaXNzaW9ucy50c1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2NoZWR1bGVkRXZlbnQoYm90OiBCb3RXaXRoQ2FjaGUpIHtcbiAgY29uc3QgY3JlYXRlU2NoZWR1bGVkRXZlbnRPbGQgPSBib3QuaGVscGVycy5jcmVhdGVTY2hlZHVsZWRFdmVudDtcblxuICBib3QuaGVscGVycy5jcmVhdGVTY2hlZHVsZWRFdmVudCA9IGFzeW5jIGZ1bmN0aW9uIChndWlsZElkLCBvcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMuZW50aXR5VHlwZSA9PT0gU2NoZWR1bGVkRXZlbnRFbnRpdHlUeXBlLlN0YWdlSW5zdGFuY2UpIHtcbiAgICAgIGlmICghb3B0aW9ucy5jaGFubmVsSWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgIFwiQSBjaGFubmVsIGlkIGlzIHJlcXVpcmVkIGZvciBjcmVhdGluZyBhIHN0YWdlIHNjaGVkdWxlZCBldmVudC5cIixcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgcmVxdWlyZUJvdENoYW5uZWxQZXJtaXNzaW9ucyhib3QsIG9wdGlvbnMuY2hhbm5lbElkLCBbXG4gICAgICAgIFwiTUFOQUdFX0NIQU5ORUxTXCIsXG4gICAgICAgIFwiTVVURV9NRU1CRVJTXCIsXG4gICAgICAgIFwiTU9WRV9NRU1CRVJTXCIsXG4gICAgICBdKTtcblxuICAgICAgLy8gTUFOQUdFX0VWRU5UUyBhdCB0aGUgZ3VpbGQgbGV2ZWwgb3IgYXQgbGVhc3QgTUFOQUdFX0VWRU5UUyBmb3IgdGhlIGNoYW5uZWxfaWQgYXNzb2NpYXRlZCB3aXRoIHRoZSBldmVudFxuICAgICAgdHJ5IHtcbiAgICAgICAgcmVxdWlyZUJvdEd1aWxkUGVybWlzc2lvbnMoYm90LCBndWlsZElkLCBbXG4gICAgICAgICAgXCJNQU5BR0VfRVZFTlRTXCIsXG4gICAgICAgIF0pO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIHJlcXVpcmVCb3RDaGFubmVsUGVybWlzc2lvbnMoYm90LCBvcHRpb25zLmNoYW5uZWxJZCwgW1xuICAgICAgICAgIFwiTUFOQUdFX0VWRU5UU1wiLFxuICAgICAgICBdKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNyZWF0ZVNjaGVkdWxlZEV2ZW50T2xkKGd1aWxkSWQsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGlmIChvcHRpb25zLmVudGl0eVR5cGUgPT09IFNjaGVkdWxlZEV2ZW50RW50aXR5VHlwZS5Wb2ljZSkge1xuICAgICAgaWYgKCFvcHRpb25zLmNoYW5uZWxJZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgXCJBIGNoYW5uZWwgaWQgaXMgcmVxdWlyZWQgZm9yIGNyZWF0aW5nIGEgdm9pY2Ugc2NoZWR1bGVkIGV2ZW50LlwiLFxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICByZXF1aXJlQm90Q2hhbm5lbFBlcm1pc3Npb25zKGJvdCwgb3B0aW9ucy5jaGFubmVsSWQsIFtcbiAgICAgICAgXCJWSUVXX0NIQU5ORUxcIixcbiAgICAgICAgXCJDT05ORUNUXCIsXG4gICAgICBdKTtcblxuICAgICAgLy8gTUFOQUdFX0VWRU5UUyBhdCB0aGUgZ3VpbGQgbGV2ZWwgb3IgYXQgbGVhc3QgTUFOQUdFX0VWRU5UUyBmb3IgdGhlIGNoYW5uZWxfaWQgYXNzb2NpYXRlZCB3aXRoIHRoZSBldmVudFxuICAgICAgdHJ5IHtcbiAgICAgICAgcmVxdWlyZUJvdEd1aWxkUGVybWlzc2lvbnMoYm90LCBndWlsZElkLCBbXG4gICAgICAgICAgXCJNQU5BR0VfRVZFTlRTXCIsXG4gICAgICAgIF0pO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIHJlcXVpcmVCb3RDaGFubmVsUGVybWlzc2lvbnMoYm90LCBvcHRpb25zLmNoYW5uZWxJZCwgW1xuICAgICAgICAgIFwiTUFOQUdFX0VWRU5UU1wiLFxuICAgICAgICBdKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNyZWF0ZVNjaGVkdWxlZEV2ZW50T2xkKGd1aWxkSWQsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIC8vIEVYVEVSTkFMIEVWRU5UU1xuXG4gICAgcmVxdWlyZUJvdEd1aWxkUGVybWlzc2lvbnMoYm90LCBndWlsZElkLCBbXG4gICAgICBcIk1BTkFHRV9FVkVOVFNcIixcbiAgICBdKTtcblxuICAgIHJldHVybiBhd2FpdCBjcmVhdGVTY2hlZHVsZWRFdmVudE9sZChndWlsZElkLCBvcHRpb25zKTtcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVkaXRTY2hlZHVsZWRFdmVudChib3Q6IEJvdFdpdGhDYWNoZSkge1xuICBjb25zdCBlZGl0U2NoZWR1bGVkRXZlbnRPbGQgPSBib3QuaGVscGVycy5lZGl0U2NoZWR1bGVkRXZlbnQ7XG5cbiAgYm90LmhlbHBlcnMuZWRpdFNjaGVkdWxlZEV2ZW50ID0gYXN5bmMgZnVuY3Rpb24gKGd1aWxkSWQsIGV2ZW50SWQsIG9wdGlvbnMpIHtcbiAgICBpZiAob3B0aW9ucy5lbnRpdHlUeXBlID09PSBTY2hlZHVsZWRFdmVudEVudGl0eVR5cGUuU3RhZ2VJbnN0YW5jZSkge1xuICAgICAgaWYgKCFvcHRpb25zLmNoYW5uZWxJZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgXCJBIGNoYW5uZWwgaWQgaXMgcmVxdWlyZWQgZm9yIGNyZWF0aW5nIGEgc3RhZ2Ugc2NoZWR1bGVkIGV2ZW50LlwiLFxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICByZXF1aXJlQm90Q2hhbm5lbFBlcm1pc3Npb25zKGJvdCwgb3B0aW9ucy5jaGFubmVsSWQsIFtcbiAgICAgICAgXCJNQU5BR0VfQ0hBTk5FTFNcIixcbiAgICAgICAgXCJNVVRFX01FTUJFUlNcIixcbiAgICAgICAgXCJNT1ZFX01FTUJFUlNcIixcbiAgICAgIF0pO1xuXG4gICAgICAvLyBNQU5BR0VfRVZFTlRTIGF0IHRoZSBndWlsZCBsZXZlbCBvciBhdCBsZWFzdCBNQU5BR0VfRVZFTlRTIGZvciB0aGUgY2hhbm5lbF9pZCBhc3NvY2lhdGVkIHdpdGggdGhlIGV2ZW50XG4gICAgICB0cnkge1xuICAgICAgICByZXF1aXJlQm90R3VpbGRQZXJtaXNzaW9ucyhib3QsIGd1aWxkSWQsIFtcbiAgICAgICAgICBcIk1BTkFHRV9FVkVOVFNcIixcbiAgICAgICAgXSk7XG4gICAgICB9IGNhdGNoIHtcbiAgICAgICAgcmVxdWlyZUJvdENoYW5uZWxQZXJtaXNzaW9ucyhib3QsIG9wdGlvbnMuY2hhbm5lbElkLCBbXG4gICAgICAgICAgXCJNQU5BR0VfRVZFTlRTXCIsXG4gICAgICAgIF0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZWRpdFNjaGVkdWxlZEV2ZW50T2xkKGd1aWxkSWQsIGV2ZW50SWQsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGlmIChvcHRpb25zLmVudGl0eVR5cGUgPT09IFNjaGVkdWxlZEV2ZW50RW50aXR5VHlwZS5Wb2ljZSkge1xuICAgICAgaWYgKCFvcHRpb25zLmNoYW5uZWxJZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgXCJBIGNoYW5uZWwgaWQgaXMgcmVxdWlyZWQgZm9yIGNyZWF0aW5nIGEgdm9pY2Ugc2NoZWR1bGVkIGV2ZW50LlwiLFxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICByZXF1aXJlQm90Q2hhbm5lbFBlcm1pc3Npb25zKGJvdCwgb3B0aW9ucy5jaGFubmVsSWQsIFtcbiAgICAgICAgXCJWSUVXX0NIQU5ORUxcIixcbiAgICAgICAgXCJDT05ORUNUXCIsXG4gICAgICBdKTtcblxuICAgICAgLy8gTUFOQUdFX0VWRU5UUyBhdCB0aGUgZ3VpbGQgbGV2ZWwgb3IgYXQgbGVhc3QgTUFOQUdFX0VWRU5UUyBmb3IgdGhlIGNoYW5uZWxfaWQgYXNzb2NpYXRlZCB3aXRoIHRoZSBldmVudFxuICAgICAgdHJ5IHtcbiAgICAgICAgcmVxdWlyZUJvdEd1aWxkUGVybWlzc2lvbnMoYm90LCBndWlsZElkLCBbXG4gICAgICAgICAgXCJNQU5BR0VfRVZFTlRTXCIsXG4gICAgICAgIF0pO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIHJlcXVpcmVCb3RDaGFubmVsUGVybWlzc2lvbnMoYm90LCBvcHRpb25zLmNoYW5uZWxJZCwgW1xuICAgICAgICAgIFwiTUFOQUdFX0VWRU5UU1wiLFxuICAgICAgICBdKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGVkaXRTY2hlZHVsZWRFdmVudE9sZChndWlsZElkLCBldmVudElkLCBvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvLyBFWFRFUk5BTCBFVkVOVFNcblxuICAgIHJlcXVpcmVCb3RHdWlsZFBlcm1pc3Npb25zKGJvdCwgZ3VpbGRJZCwgW1xuICAgICAgXCJNQU5BR0VfRVZFTlRTXCIsXG4gICAgXSk7XG5cbiAgICByZXR1cm4gYXdhaXQgZWRpdFNjaGVkdWxlZEV2ZW50T2xkKGd1aWxkSWQsIGV2ZW50SWQsIG9wdGlvbnMpO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBzZXR1cEV2ZW50c1Blcm1DaGVja3MoYm90OiBCb3RXaXRoQ2FjaGUpIHtcbiAgY3JlYXRlU2NoZWR1bGVkRXZlbnQoYm90KTtcbiAgZWRpdFNjaGVkdWxlZEV2ZW50KGJvdCk7XG59XG4iXX0=