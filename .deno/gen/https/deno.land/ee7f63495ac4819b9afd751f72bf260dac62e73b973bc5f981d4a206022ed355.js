import { MessageComponentTypes } from "../../../types/shared.ts";
export async function editInteractionResponse(bot, token, options) {
    const result = await bot.rest.runMethod(bot.rest, "PATCH", options.messageId
        ? bot.constants.routes.WEBHOOK_MESSAGE(bot.applicationId, token, options.messageId)
        : bot.constants.routes.INTERACTION_ORIGINAL_ID_TOKEN(bot.applicationId, token), {
        content: options.content,
        embeds: options.embeds?.map((embed) => bot.transformers.reverse.embed(bot, embed)),
        file: options.file,
        allowed_mentions: options.allowedMentions
            ? {
                parse: options.allowedMentions.parse,
                roles: options.allowedMentions.roles?.map((id) => id.toString()),
                users: options.allowedMentions.users?.map((id) => id.toString()),
                replied_user: options.allowedMentions.repliedUser,
            }
            : undefined,
        attachments: options.attachments?.map((attachment) => ({
            id: attachment.id.toString(),
            filename: attachment.filename,
            content_type: attachment.contentType,
            size: attachment.size,
            url: attachment.url,
            proxy_url: attachment.proxyUrl,
            height: attachment.height,
            width: attachment.width,
            ephemeral: attachment.ephemeral,
        })),
        components: options.components?.map((component) => ({
            type: component.type,
            components: component.components.map((subComponent) => {
                if (subComponent.type === MessageComponentTypes.InputText) {
                    return {
                        type: subComponent.type,
                        style: subComponent.style,
                        custom_id: subComponent.customId,
                        label: subComponent.label,
                        placeholder: subComponent.placeholder,
                        min_length: subComponent.minLength ?? subComponent.required === false ? 0 : subComponent.minLength,
                        max_length: subComponent.maxLength,
                    };
                }
                if (subComponent.type === MessageComponentTypes.SelectMenu) {
                    return {
                        type: subComponent.type,
                        custom_id: subComponent.customId,
                        placeholder: subComponent.placeholder,
                        min_values: subComponent.minValues,
                        max_values: subComponent.maxValues,
                        options: subComponent.options.map((option) => ({
                            label: option.label,
                            value: option.value,
                            description: option.description,
                            emoji: option.emoji
                                ? {
                                    id: option.emoji.id?.toString(),
                                    name: option.emoji.name,
                                    animated: option.emoji.animated,
                                }
                                : undefined,
                            default: option.default,
                        })),
                    };
                }
                return {
                    type: subComponent.type,
                    custom_id: subComponent.customId,
                    label: subComponent.label,
                    style: subComponent.style,
                    emoji: "emoji" in subComponent && subComponent.emoji
                        ? {
                            id: subComponent.emoji.id?.toString(),
                            name: subComponent.emoji.name,
                            animated: subComponent.emoji.animated,
                        }
                        : undefined,
                    url: "url" in subComponent ? subComponent.url : undefined,
                    disabled: "disabled" in subComponent ? subComponent.disabled : undefined,
                };
            }),
        })),
        message_id: options.messageId?.toString(),
    });
    if (!options.messageId)
        return result;
    return bot.transformers.message(bot, result);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWRpdEludGVyYWN0aW9uUmVzcG9uc2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJlZGl0SW50ZXJhY3Rpb25SZXNwb25zZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUlqRSxNQUFNLENBQUMsS0FBSyxVQUFVLHVCQUF1QixDQUMzQyxHQUFRLEVBQ1IsS0FBYSxFQUNiLE9BR0M7SUFFRCxNQUFNLE1BQU0sR0FBRyxNQUFNLEdBQUcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUNyQyxHQUFHLENBQUMsSUFBSSxFQUNSLE9BQU8sRUFDUCxPQUFPLENBQUMsU0FBUztRQUNmLENBQUMsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxLQUFLLEVBQUUsT0FBTyxDQUFDLFNBQVMsQ0FBQztRQUNuRixDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsNkJBQTZCLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxLQUFLLENBQUMsRUFDaEY7UUFDRSxPQUFPLEVBQUUsT0FBTyxDQUFDLE9BQU87UUFDeEIsTUFBTSxFQUFFLE9BQU8sQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ2xGLElBQUksRUFBRSxPQUFPLENBQUMsSUFBSTtRQUNsQixnQkFBZ0IsRUFBRSxPQUFPLENBQUMsZUFBZTtZQUN2QyxDQUFDLENBQUM7Z0JBQ0EsS0FBSyxFQUFFLE9BQU8sQ0FBQyxlQUFlLENBQUMsS0FBSztnQkFDcEMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLFFBQVEsRUFBRSxDQUFDO2dCQUNoRSxLQUFLLEVBQUUsT0FBTyxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsR0FBRyxDQUFDLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUM7Z0JBQ2hFLFlBQVksRUFBRSxPQUFPLENBQUMsZUFBZSxDQUFDLFdBQVc7YUFDbEQ7WUFDRCxDQUFDLENBQUMsU0FBUztRQUNiLFdBQVcsRUFBRSxPQUFPLENBQUMsV0FBVyxFQUFFLEdBQUcsQ0FBQyxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUNyRCxFQUFFLEVBQUUsVUFBVSxDQUFDLEVBQUUsQ0FBQyxRQUFRLEVBQUU7WUFDNUIsUUFBUSxFQUFFLFVBQVUsQ0FBQyxRQUFRO1lBQzdCLFlBQVksRUFBRSxVQUFVLENBQUMsV0FBVztZQUNwQyxJQUFJLEVBQUUsVUFBVSxDQUFDLElBQUk7WUFDckIsR0FBRyxFQUFFLFVBQVUsQ0FBQyxHQUFHO1lBQ25CLFNBQVMsRUFBRSxVQUFVLENBQUMsUUFBUTtZQUM5QixNQUFNLEVBQUUsVUFBVSxDQUFDLE1BQU07WUFDekIsS0FBSyxFQUFFLFVBQVUsQ0FBQyxLQUFLO1lBQ3ZCLFNBQVMsRUFBRSxVQUFVLENBQUMsU0FBUztTQUNoQyxDQUFDLENBQUM7UUFDSCxVQUFVLEVBQUUsT0FBTyxDQUFDLFVBQVUsRUFBRSxHQUFHLENBQUMsQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDbEQsSUFBSSxFQUFFLFNBQVMsQ0FBQyxJQUFJO1lBQ3BCLFVBQVUsRUFBRSxTQUFTLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFlBQVksRUFBRSxFQUFFO2dCQUNwRCxJQUFJLFlBQVksQ0FBQyxJQUFJLEtBQUsscUJBQXFCLENBQUMsU0FBUyxFQUFFO29CQUN6RCxPQUFPO3dCQUNMLElBQUksRUFBRSxZQUFZLENBQUMsSUFBSTt3QkFDdkIsS0FBSyxFQUFFLFlBQVksQ0FBQyxLQUFLO3dCQUN6QixTQUFTLEVBQUUsWUFBWSxDQUFDLFFBQVE7d0JBQ2hDLEtBQUssRUFBRSxZQUFZLENBQUMsS0FBSzt3QkFDekIsV0FBVyxFQUFFLFlBQVksQ0FBQyxXQUFXO3dCQUNyQyxVQUFVLEVBQUUsWUFBWSxDQUFDLFNBQVMsSUFBSSxZQUFZLENBQUMsUUFBUSxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsU0FBUzt3QkFDbEcsVUFBVSxFQUFFLFlBQVksQ0FBQyxTQUFTO3FCQUNuQyxDQUFDO2lCQUNIO2dCQUVELElBQUksWUFBWSxDQUFDLElBQUksS0FBSyxxQkFBcUIsQ0FBQyxVQUFVLEVBQUU7b0JBQzFELE9BQU87d0JBQ0wsSUFBSSxFQUFFLFlBQVksQ0FBQyxJQUFJO3dCQUN2QixTQUFTLEVBQUUsWUFBWSxDQUFDLFFBQVE7d0JBQ2hDLFdBQVcsRUFBRSxZQUFZLENBQUMsV0FBVzt3QkFDckMsVUFBVSxFQUFFLFlBQVksQ0FBQyxTQUFTO3dCQUNsQyxVQUFVLEVBQUUsWUFBWSxDQUFDLFNBQVM7d0JBQ2xDLE9BQU8sRUFBRSxZQUFZLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsQ0FBQzs0QkFDN0MsS0FBSyxFQUFFLE1BQU0sQ0FBQyxLQUFLOzRCQUNuQixLQUFLLEVBQUUsTUFBTSxDQUFDLEtBQUs7NEJBQ25CLFdBQVcsRUFBRSxNQUFNLENBQUMsV0FBVzs0QkFDL0IsS0FBSyxFQUFFLE1BQU0sQ0FBQyxLQUFLO2dDQUNqQixDQUFDLENBQUM7b0NBQ0EsRUFBRSxFQUFFLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLFFBQVEsRUFBRTtvQ0FDL0IsSUFBSSxFQUFFLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSTtvQ0FDdkIsUUFBUSxFQUFFLE1BQU0sQ0FBQyxLQUFLLENBQUMsUUFBUTtpQ0FDaEM7Z0NBQ0QsQ0FBQyxDQUFDLFNBQVM7NEJBQ2IsT0FBTyxFQUFFLE1BQU0sQ0FBQyxPQUFPO3lCQUN4QixDQUFDLENBQUM7cUJBQ0osQ0FBQztpQkFDSDtnQkFFRCxPQUFPO29CQUNMLElBQUksRUFBRSxZQUFZLENBQUMsSUFBSTtvQkFDdkIsU0FBUyxFQUFFLFlBQVksQ0FBQyxRQUFRO29CQUNoQyxLQUFLLEVBQUUsWUFBWSxDQUFDLEtBQUs7b0JBQ3pCLEtBQUssRUFBRSxZQUFZLENBQUMsS0FBSztvQkFDekIsS0FBSyxFQUFFLE9BQU8sSUFBSSxZQUFZLElBQUksWUFBWSxDQUFDLEtBQUs7d0JBQ2xELENBQUMsQ0FBQzs0QkFDQSxFQUFFLEVBQUUsWUFBWSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsUUFBUSxFQUFFOzRCQUNyQyxJQUFJLEVBQUUsWUFBWSxDQUFDLEtBQUssQ0FBQyxJQUFJOzRCQUM3QixRQUFRLEVBQUUsWUFBWSxDQUFDLEtBQUssQ0FBQyxRQUFRO3lCQUN0Qzt3QkFDRCxDQUFDLENBQUMsU0FBUztvQkFDYixHQUFHLEVBQUUsS0FBSyxJQUFJLFlBQVksQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsU0FBUztvQkFDekQsUUFBUSxFQUFFLFVBQVUsSUFBSSxZQUFZLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLFNBQVM7aUJBQ3pFLENBQUM7WUFDSixDQUFDLENBQUM7U0FDSCxDQUFDLENBQUM7UUFDSCxVQUFVLEVBQUUsT0FBTyxDQUFDLFNBQVMsRUFBRSxRQUFRLEVBQUU7S0FDMUMsQ0FDRixDQUFDO0lBR0YsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTO1FBQUUsT0FBTyxNQUFtQixDQUFDO0lBRW5ELE9BQU8sR0FBRyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBQy9DLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEJvdCB9IGZyb20gXCIuLi8uLi8uLi9ib3QudHNcIjtcbmltcG9ydCB7IE1lc3NhZ2VDb21wb25lbnRUeXBlcyB9IGZyb20gXCIuLi8uLi8uLi90eXBlcy9zaGFyZWQudHNcIjtcbmltcG9ydCB7IEVkaXRXZWJob29rTWVzc2FnZSB9IGZyb20gXCIuLi8uLi93ZWJob29rcy9lZGl0V2ViaG9va01lc3NhZ2UudHNcIjtcblxuLyoqIFRvIGVkaXQgeW91ciByZXNwb25zZSB0byBhIGFwcGxpY2F0aW9uIGNvbW1hbmQuIElmIGEgbWVzc2FnZUlkIGlzIG5vdCBwcm92aWRlZCBpdCB3aWxsIGRlZmF1bHQgdG8gZWRpdGluZyB0aGUgb3JpZ2luYWwgcmVzcG9uc2UuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZWRpdEludGVyYWN0aW9uUmVzcG9uc2UoXG4gIGJvdDogQm90LFxuICB0b2tlbjogc3RyaW5nLFxuICBvcHRpb25zOiBFZGl0V2ViaG9va01lc3NhZ2UgJiB7XG4gICAgLyoqIElkIG9mIHRoZSBtZXNzYWdlIHlvdSB3YW50IHRvIGVkaXQgaWYgdW5kZWZpbmVkIHRoZSBpbml0aWFsIHJlc3BvbnNlIG1lc3NhZ2Ugd2lsbCBiZSBlZGl0ZWQgKi9cbiAgICBtZXNzYWdlSWQ/OiBiaWdpbnQ7XG4gIH0sXG4pIHtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYm90LnJlc3QucnVuTWV0aG9kKFxuICAgIGJvdC5yZXN0LFxuICAgIFwiUEFUQ0hcIixcbiAgICBvcHRpb25zLm1lc3NhZ2VJZFxuICAgICAgPyBib3QuY29uc3RhbnRzLnJvdXRlcy5XRUJIT09LX01FU1NBR0UoYm90LmFwcGxpY2F0aW9uSWQsIHRva2VuLCBvcHRpb25zLm1lc3NhZ2VJZClcbiAgICAgIDogYm90LmNvbnN0YW50cy5yb3V0ZXMuSU5URVJBQ1RJT05fT1JJR0lOQUxfSURfVE9LRU4oYm90LmFwcGxpY2F0aW9uSWQsIHRva2VuKSxcbiAgICB7XG4gICAgICBjb250ZW50OiBvcHRpb25zLmNvbnRlbnQsXG4gICAgICBlbWJlZHM6IG9wdGlvbnMuZW1iZWRzPy5tYXAoKGVtYmVkKSA9PiBib3QudHJhbnNmb3JtZXJzLnJldmVyc2UuZW1iZWQoYm90LCBlbWJlZCkpLFxuICAgICAgZmlsZTogb3B0aW9ucy5maWxlLFxuICAgICAgYWxsb3dlZF9tZW50aW9uczogb3B0aW9ucy5hbGxvd2VkTWVudGlvbnNcbiAgICAgICAgPyB7XG4gICAgICAgICAgcGFyc2U6IG9wdGlvbnMuYWxsb3dlZE1lbnRpb25zLnBhcnNlLFxuICAgICAgICAgIHJvbGVzOiBvcHRpb25zLmFsbG93ZWRNZW50aW9ucy5yb2xlcz8ubWFwKChpZCkgPT4gaWQudG9TdHJpbmcoKSksXG4gICAgICAgICAgdXNlcnM6IG9wdGlvbnMuYWxsb3dlZE1lbnRpb25zLnVzZXJzPy5tYXAoKGlkKSA9PiBpZC50b1N0cmluZygpKSxcbiAgICAgICAgICByZXBsaWVkX3VzZXI6IG9wdGlvbnMuYWxsb3dlZE1lbnRpb25zLnJlcGxpZWRVc2VyLFxuICAgICAgICB9XG4gICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgYXR0YWNobWVudHM6IG9wdGlvbnMuYXR0YWNobWVudHM/Lm1hcCgoYXR0YWNobWVudCkgPT4gKHtcbiAgICAgICAgaWQ6IGF0dGFjaG1lbnQuaWQudG9TdHJpbmcoKSxcbiAgICAgICAgZmlsZW5hbWU6IGF0dGFjaG1lbnQuZmlsZW5hbWUsXG4gICAgICAgIGNvbnRlbnRfdHlwZTogYXR0YWNobWVudC5jb250ZW50VHlwZSxcbiAgICAgICAgc2l6ZTogYXR0YWNobWVudC5zaXplLFxuICAgICAgICB1cmw6IGF0dGFjaG1lbnQudXJsLFxuICAgICAgICBwcm94eV91cmw6IGF0dGFjaG1lbnQucHJveHlVcmwsXG4gICAgICAgIGhlaWdodDogYXR0YWNobWVudC5oZWlnaHQsXG4gICAgICAgIHdpZHRoOiBhdHRhY2htZW50LndpZHRoLFxuICAgICAgICBlcGhlbWVyYWw6IGF0dGFjaG1lbnQuZXBoZW1lcmFsLFxuICAgICAgfSkpLFxuICAgICAgY29tcG9uZW50czogb3B0aW9ucy5jb21wb25lbnRzPy5tYXAoKGNvbXBvbmVudCkgPT4gKHtcbiAgICAgICAgdHlwZTogY29tcG9uZW50LnR5cGUsXG4gICAgICAgIGNvbXBvbmVudHM6IGNvbXBvbmVudC5jb21wb25lbnRzLm1hcCgoc3ViQ29tcG9uZW50KSA9PiB7XG4gICAgICAgICAgaWYgKHN1YkNvbXBvbmVudC50eXBlID09PSBNZXNzYWdlQ29tcG9uZW50VHlwZXMuSW5wdXRUZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICB0eXBlOiBzdWJDb21wb25lbnQudHlwZSxcbiAgICAgICAgICAgICAgc3R5bGU6IHN1YkNvbXBvbmVudC5zdHlsZSxcbiAgICAgICAgICAgICAgY3VzdG9tX2lkOiBzdWJDb21wb25lbnQuY3VzdG9tSWQsXG4gICAgICAgICAgICAgIGxhYmVsOiBzdWJDb21wb25lbnQubGFiZWwsXG4gICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiBzdWJDb21wb25lbnQucGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAgIG1pbl9sZW5ndGg6IHN1YkNvbXBvbmVudC5taW5MZW5ndGggPz8gc3ViQ29tcG9uZW50LnJlcXVpcmVkID09PSBmYWxzZSA/IDAgOiBzdWJDb21wb25lbnQubWluTGVuZ3RoLFxuICAgICAgICAgICAgICBtYXhfbGVuZ3RoOiBzdWJDb21wb25lbnQubWF4TGVuZ3RoLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoc3ViQ29tcG9uZW50LnR5cGUgPT09IE1lc3NhZ2VDb21wb25lbnRUeXBlcy5TZWxlY3RNZW51KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICB0eXBlOiBzdWJDb21wb25lbnQudHlwZSxcbiAgICAgICAgICAgICAgY3VzdG9tX2lkOiBzdWJDb21wb25lbnQuY3VzdG9tSWQsXG4gICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiBzdWJDb21wb25lbnQucGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAgIG1pbl92YWx1ZXM6IHN1YkNvbXBvbmVudC5taW5WYWx1ZXMsXG4gICAgICAgICAgICAgIG1heF92YWx1ZXM6IHN1YkNvbXBvbmVudC5tYXhWYWx1ZXMsXG4gICAgICAgICAgICAgIG9wdGlvbnM6IHN1YkNvbXBvbmVudC5vcHRpb25zLm1hcCgob3B0aW9uKSA9PiAoe1xuICAgICAgICAgICAgICAgIGxhYmVsOiBvcHRpb24ubGFiZWwsXG4gICAgICAgICAgICAgICAgdmFsdWU6IG9wdGlvbi52YWx1ZSxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogb3B0aW9uLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgIGVtb2ppOiBvcHRpb24uZW1vamlcbiAgICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICBpZDogb3B0aW9uLmVtb2ppLmlkPy50b1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBvcHRpb24uZW1vamkubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0ZWQ6IG9wdGlvbi5lbW9qaS5hbmltYXRlZCxcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IG9wdGlvbi5kZWZhdWx0LFxuICAgICAgICAgICAgICB9KSksXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiBzdWJDb21wb25lbnQudHlwZSxcbiAgICAgICAgICAgIGN1c3RvbV9pZDogc3ViQ29tcG9uZW50LmN1c3RvbUlkLFxuICAgICAgICAgICAgbGFiZWw6IHN1YkNvbXBvbmVudC5sYWJlbCxcbiAgICAgICAgICAgIHN0eWxlOiBzdWJDb21wb25lbnQuc3R5bGUsXG4gICAgICAgICAgICBlbW9qaTogXCJlbW9qaVwiIGluIHN1YkNvbXBvbmVudCAmJiBzdWJDb21wb25lbnQuZW1vamlcbiAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgaWQ6IHN1YkNvbXBvbmVudC5lbW9qaS5pZD8udG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICBuYW1lOiBzdWJDb21wb25lbnQuZW1vamkubmFtZSxcbiAgICAgICAgICAgICAgICBhbmltYXRlZDogc3ViQ29tcG9uZW50LmVtb2ppLmFuaW1hdGVkLFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgdXJsOiBcInVybFwiIGluIHN1YkNvbXBvbmVudCA/IHN1YkNvbXBvbmVudC51cmwgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBkaXNhYmxlZDogXCJkaXNhYmxlZFwiIGluIHN1YkNvbXBvbmVudCA/IHN1YkNvbXBvbmVudC5kaXNhYmxlZCA6IHVuZGVmaW5lZCxcbiAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgIH0pKSxcbiAgICAgIG1lc3NhZ2VfaWQ6IG9wdGlvbnMubWVzc2FnZUlkPy50b1N0cmluZygpLFxuICAgIH0sXG4gICk7XG5cbiAgLy8gSWYgdGhlIG9yaWdpbmFsIG1lc3NhZ2Ugd2FzIGVkaXRlZCwgdGhpcyB3aWxsIG5vdCByZXR1cm4gYSBtZXNzYWdlXG4gIGlmICghb3B0aW9ucy5tZXNzYWdlSWQpIHJldHVybiByZXN1bHQgYXMgdW5kZWZpbmVkO1xuXG4gIHJldHVybiBib3QudHJhbnNmb3JtZXJzLm1lc3NhZ2UoYm90LCByZXN1bHQpO1xufVxuIl19